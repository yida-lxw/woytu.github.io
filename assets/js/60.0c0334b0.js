(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{647:function(t,s,e){"use strict";e.r(s);var n=e(4),a=Object(n.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"python爬虫"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#python爬虫"}},[t._v("#")]),t._v(" Python爬虫")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),e("li",[e("a",{attrs:{href:"#headlessbrowser"}},[t._v("HeadlessBrowser")]),e("ul",[e("li",[e("a",{attrs:{href:"#chromedriver"}},[t._v("chromedriver")])])])]),e("li",[e("a",{attrs:{href:"#selenium"}},[t._v("selenium")]),e("ul",[e("li",[e("a",{attrs:{href:"#函数或变量"}},[t._v("函数或变量")])])])]),e("li",[e("a",{attrs:{href:"#浏览器下载设置"}},[t._v("浏览器下载设置")]),e("ul",[e("li",[e("a",{attrs:{href:"#打开新标签页"}},[t._v("打开新标签页")])]),e("li",[e("a",{attrs:{href:"#执行javascript"}},[t._v("执行JavaScript")])])])]),e("li",[e("a",{attrs:{href:"#m3u8解析下载解密合并"}},[t._v("m3u8解析下载解密合并")])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"flag"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/topics/scraper",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/scraper"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/webscraper",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/webscraper"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/web-scraper",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/web-scraper"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/spider",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/spider"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/webscraper",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/webscraper"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/web-scraper",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/web-scraper"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/crawler",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/crawler"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/webcrawler",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/webcrawler"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/web-crawler",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/web-crawler"),e("OutboundLink")],1)])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/HiddenStrawberry/Crawler_Illegal_Cases_In_China",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/HiddenStrawberry/Crawler_Illegal_Cases_In_China"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://blog.csdn.net/wkb342814892/article/details/81591394",target:"_blank",rel:"noopener noreferrer"}},[t._v("xvfb可以将屏幕的图像输出给放到虚拟内存中"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/scrapy/scrapy",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/scrapy/scrapy"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("strong",[e("RouterLink",{attrs:{to:"/Web/#xpath和css选择器"}},[t._v("xpath和css选择器")])],1)]),t._v(" "),e("ul",[e("li",[t._v("批量杀死"),e("code",[t._v("chromedriver")]),t._v("进程")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -efww"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("LOCAL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("chromedriver"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" -v "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cut")]),t._v(" -c "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("-15"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" -9\n")])])]),e("div",{staticClass:"language-batch extra-class"},[e("pre",{pre:!0,attrs:{class:"language-batch"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v(":: Windows")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token command"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("taskkill")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("/f")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("/im")]),t._v(" chromedriver.exe")]),t._v("\n")])])]),e("ul",[e("li",[e("a",{attrs:{href:"https://blog.csdn.net/python_neophyte/article/details/82562330",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于网页referer以及破解referer反爬虫的办法"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("ReCaptcha验证码（常见为Google验证码） "),e("a",{attrs:{href:"https://github.com/topics/captcha-solving",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/captcha-solving"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/teal33t/captcha_bypass",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/teal33t/captcha_bypass"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/NotHassan/Python-Google-Recaptcha-v2-Solver",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/NotHassan/Python-Google-Recaptcha-v2-Solver"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/balanceofprobability/decaptcha",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/balanceofprobability/decaptcha"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/IshanManchanda/pyreCAPTCHA",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/IshanManchanda/pyreCAPTCHA"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/tafalk/recaptcha-token-resolver-function",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/tafalk/recaptcha-token-resolver-function"),e("OutboundLink")],1)])])]),t._v(" "),e("li",[t._v("使用HTTP拦截器来实现cloudflare请求 "),e("a",{attrs:{href:"https://github.com/sayem314/hooman",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/sayem314/hooman"),e("OutboundLink")],1)])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/DropsDevopsOrg/ECommerceCrawlers/wiki/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%88%AC%E5%8F%96%E7%A0%94%E7%A9%B6",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信公众号爬取研究"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/search?o=desc&q=%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%88%AC%E8%99%AB&s=updated&type=Repositories",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信公众号爬虫"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/wnma3mz/wechat_articles_spider",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/wnma3mz/wechat_articles_spider"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/search?o=desc&q=WeChat+Hook&s=updated&type=Repositories",target:"_blank",rel:"noopener noreferrer"}},[t._v("WeChat Hook"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/redtips/wechathook",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/redtips/wechathook"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/wwg88888888/WeChatExt",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/wwg88888888/WeChatExt"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/TonyChen56/WeChatRobot",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/TonyChen56/WeChatRobot"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/KongKong20/WeChatPCHook",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/KongKong20/WeChatPCHook"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://i.ijrou.com/p/story/WeChatDownload.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("WeChatDownload，批量微信公众号文章下载小工具"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/LeLe86/vWeChatCrawl",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/LeLe86/vWeChatCrawl"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"headlessbrowser"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#headlessbrowser"}},[t._v("#")]),t._v(" HeadlessBrowser")]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("Headless Browser")]),t._v("(无头的浏览器)是没有图形用户界面(GUI)的web浏览器，通常是通过编程或命令行界面来控制的")])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/topics/webdriver",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/webdriver"),e("OutboundLink")],1)])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://w3c.github.io/webdriver",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://w3c.github.io/webdriver"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.jianshu.com/p/11d519e2d0cb",target:"_blank",rel:"noopener noreferrer"}},[t._v("Headless Browser"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/mozilla/geckodriver",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/mozilla/geckodriver"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/headless-browser",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/headless-browser"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("strong",[t._v("反爬虫")])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/intoli/intoli-article-materials",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/intoli/intoli-article-materials"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://intoli.com/blog/not-possible-to-block-chrome-headless/chrome-headless-test.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("无头浏览器检测"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://mlln.cn/2019/07/05/%E7%88%AC%E8%99%AB%E5%A6%82%E4%BD%95%E9%9A%90%E8%97%8FHeadles-Chrome%E4%B8%8D%E8%A2%AB%E6%A3%80%E6%B5%8B%E5%87%BA%E6%9D%A5",target:"_blank",rel:"noopener noreferrer"}},[t._v("隐藏Headles-Chrome不被检测出来"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"chromedriver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chromedriver"}},[t._v("#")]),t._v(" chromedriver")]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("Selenium")]),t._v("操作"),e("code",[t._v("Chrome")]),t._v("浏览器需要有"),e("code",[t._v("ChromeDriver")]),t._v("驱动来协助，"),e("code",[t._v("ChromeDriver")]),t._v("与"),e("code",[t._v("Chrome")]),t._v("版本对应关系一定要正确")])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://chromedriver.storage.googleapis.com/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://chromedriver.storage.googleapis.com/index.html"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://npm.taobao.org/mirrors/chromedriver",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://npm.taobao.org/mirrors/chromedriver"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://developers.google.com/web/updates/2017/04/headless-chrome",target:"_blank",rel:"noopener noreferrer"}},[t._v("headless-chrome官方文档"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://sites.google.com/a/chromium.org/chromedriver/capabilities",target:"_blank",rel:"noopener noreferrer"}},[t._v("功能和ChromeOptions官方网站参考"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("strong",[t._v("参数列表")])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://peter.sh/experiments/chromium-command-line-switches",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://peter.sh/experiments/chromium-command-line-switches/"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://cs.chromium.org/chromium/src/content/public/common/content_switches.cc",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cs.chromium.org/chromium/src/content/public/common/content_switches.cc"),e("OutboundLink")],1)])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("参数")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("-blink-settings=imagesEnabled=false")]),t._v(" "),e("td",[t._v("不加载图片, 此方式只针对单个标签页")])]),t._v(" "),e("tr",[e("td",[t._v("-bookmark-menu")]),t._v(" "),e("td",[t._v("在工具 栏增加一个书签按钮")])]),t._v(" "),e("tr",[e("td",[t._v("-default-browser-check")]),t._v(" "),e("td",[t._v("不检查默认浏览器")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-extensions")]),t._v(" "),e("td",[t._v("禁用扩展")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-gpu")]),t._v(" "),e("td",[t._v("关闭gpu,服务器一般没有显卡")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-images")]),t._v(" "),e("td",[t._v('禁用图像，建议使用"profile.managed_default_content_settings.images":2')])]),t._v(" "),e("tr",[e("td",[t._v("-disable-java")]),t._v(" "),e("td",[t._v("禁用java")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-javascript")]),t._v(" "),e("td",[t._v("禁用Javascript")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-plugins")]),t._v(" "),e("td",[t._v("禁止加载所有插件。可以通过about:plugins页面查看效果")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-popup-blocking")]),t._v(" "),e("td",[t._v("禁用弹出拦截")])]),t._v(" "),e("tr",[e("td",[t._v("-disable-software-rasterizer")]),t._v(" "),e("td",[t._v("禁用浏览器应用")])]),t._v(" "),e("tr",[e("td",[t._v('-disk-cache-dir="[PATH]"')]),t._v(" "),e("td",[t._v("指定缓存Cache路径")])]),t._v(" "),e("tr",[e("td",[t._v("-disk-cache-size=")]),t._v(" "),e("td",[t._v("指定Cache大小，单位Byte")])]),t._v(" "),e("tr",[e("td",[t._v("-enable-sync")]),t._v(" "),e("td",[t._v("启用书签同步")])]),t._v(" "),e("tr",[e("td",[t._v("-enable-udd-profiles")]),t._v(" "),e("td",[t._v("启用账户切换菜单")])]),t._v(" "),e("tr",[e("td",[t._v("-first run")]),t._v(" "),e("td",[t._v("重置到初始状态，第一次运行")])]),t._v(" "),e("tr",[e("td",[t._v("-headless")]),t._v(" "),e("td",[t._v("不开启图像界面")])]),t._v(" "),e("tr",[e("td",[t._v("-hide-scrollbars")]),t._v(" "),e("td",[t._v("隐藏滚动条, 应对一些特殊页面")])]),t._v(" "),e("tr",[e("td",[t._v("-ignore-certificate-errors")]),t._v(" "),e("td",[t._v("忽略证书错误")])]),t._v(" "),e("tr",[e("td",[t._v("-incognito")]),t._v(" "),e("td",[t._v("隐身模式启动")])]),t._v(" "),e("tr",[e("td",[t._v("-in-process-plugins")]),t._v(" "),e("td",[t._v("插件不以独立的进程运行，插件的异常崩溃，可能会导致整个页面挂掉")])]),t._v(" "),e("tr",[e("td",[t._v("-lang=zh-CN")]),t._v(" "),e("td",[t._v("设置语言为简体中文")])]),t._v(" "),e("tr",[e("td",[t._v("-media-cache-size")]),t._v(" "),e("td",[t._v("自定义多媒体缓存最大值（单位byte）")])]),t._v(" "),e("tr",[e("td",[t._v("-no-first-run")]),t._v(" "),e("td",[t._v("第一次不运行")])]),t._v(" "),e("tr",[e("td",[t._v("-no-sandbox")]),t._v(" "),e("td",[t._v("不开启沙盒模式可以减少对服务器的资源消耗,但是服务器安全性降低")])]),t._v(" "),e("tr",[e("td",[t._v('-omnibox-popup-count="num"')]),t._v(" "),e("td",[t._v("将地址栏弹出的提示菜单数量改为num个。我都改为15个了。")])]),t._v(" "),e("tr",[e("td",[t._v("-process-per-site")]),t._v(" "),e("td",[t._v("每个站点使用单独进程")])]),t._v(" "),e("tr",[e("td",[t._v("-process-per-tab")]),t._v(" "),e("td",[t._v("每个标签使用单独进程")])]),t._v(" "),e("tr",[e("td",[t._v("-proxy-pac-url")]),t._v(" "),e("td",[t._v("指定使用PAC代理时，所需要的脚本url地址")])]),t._v(" "),e("tr",[e("td",[t._v("-remote-debugging-address")]),t._v(" "),e("td",[t._v("远程调试地址 0.0.0.0 可以外网调用但是安全性低,建议使用默认值 127.0.0.1")])]),t._v(" "),e("tr",[e("td",[t._v("-remote-debugging-port")]),t._v(" "),e("td",[t._v("chrome-debug工具的端口(golang chromepd 默认端口是9222,建议不要修改)")])]),t._v(" "),e("tr",[e("td",[t._v("-single-process")]),t._v(" "),e("td",[t._v("浏览器只能以单进程运行，通常用于调试，定位bug")])]),t._v(" "),e("tr",[e("td",[t._v("-start-maximized")]),t._v(" "),e("td",[t._v("浏览器启动后，窗口默认为最大化")])]),t._v(" "),e("tr",[e("td",[t._v('-user-agent=""')]),t._v(" "),e("td",[t._v("修改HTTP请求头部的Agent字符串，可以通过about:version页面查看修改效果")])]),t._v(" "),e("tr",[e("td",[t._v('-user-data-dir="[PATH]"')]),t._v(" "),e("td",[t._v("指定用户文件夹User Data路径。")])]),t._v(" "),e("tr",[e("td",[t._v('-window-size="1600x900"')]),t._v(" "),e("td",[t._v("窗口尺寸")])])])]),t._v(" "),e("h2",{attrs:{id:"selenium"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#selenium"}},[t._v("#")]),t._v(" selenium")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/topics/selenium",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/selenium"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/topics/testing",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/topics/testing"),e("OutboundLink")],1)])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/SeleniumHQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/SeleniumHQ"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://selenium.dev/documentation/zh-cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://selenium.dev/documentation/zh-cn"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://selenium-python-zh.readthedocs.io/en/latest/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Selenium with Python中文翻译文档"),e("OutboundLink")],1)])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/seleniumbase",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/seleniumbase"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://qzmvc1.top/Python3-Selenium%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python3-Selenium开启自动化测试"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.twblogs.net/a/5c8414bdbd9eee35cd69c929/zh-cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("python+selenium 判断元素是否存在，是否可点击，是否被选中"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.jianshu.com/p/a94918d49c3c",target:"_blank",rel:"noopener noreferrer"}},[t._v("EC：expected_conditions判断页面元素"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://rumenz.com/rumenbiji/python3-selenium-scrollToBottom.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("selenium,Python3滚动到页面底部的几种解决方案"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.yuanrenxue.com/python-selenium",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python Selenium教程 - 猿人学Python"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"函数或变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#函数或变量"}},[t._v("#")]),t._v(" 函数或变量")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("函数或变量")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("def file_detector_context(self, file_detector_class, *args, **kwargs):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def mobile(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def name(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def start_client(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def stop_client(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def start_session(self, capabilities, browser_profile=None):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def create_web_element(self, element_id):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def execute(self, driver_command, params=None):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get(self, url):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def title(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_id(self, id_):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_id(self, id_):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_xpath(self, xpath):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_xpath(self, xpath):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_link_text(self, link_text):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_link_text(self, text):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_partial_link_text(self, link_text):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_partial_link_text(self, link_text):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_name(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_name(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_tag_name(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_tag_name(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_class_name(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_class_name(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element_by_css_selector(self, css_selector):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements_by_css_selector(self, css_selector):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def execute_script(self, script, *args):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def execute_async_script(self, script, *args):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def current_url(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def page_source(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def close(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def quit(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def current_window_handle(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def window_handles(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def maximize_window(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def fullscreen_window(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def minimize_window(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def switch_to(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def switch_to_active_element(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def switch_to_window(self, window_name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def switch_to_frame(self, frame_reference):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def switch_to_default_content(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def switch_to_alert(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def back(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def forward(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def refresh(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_cookies(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_cookie(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def delete_cookie(self, name):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def delete_all_cookies(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def add_cookie(self, cookie_dict):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def implicitly_wait(self, time_to_wait):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def set_script_timeout(self, time_to_wait):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def set_page_load_timeout(self, time_to_wait):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_element(self, by=By.ID, value=None):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def find_elements(self, by=By.ID, value=None):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def desired_capabilities(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_screenshot_as_file(self, filename):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def save_screenshot(self, filename):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_screenshot_as_png(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_screenshot_as_base64(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def set_window_size(self, width, height, windowHandle='current'):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_window_size(self, windowHandle='current'):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def set_window_position(self, x, y, windowHandle='current'):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_window_position(self, windowHandle='current'):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_window_rect(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def set_window_rect(self, x=None, y=None, width=None, height=None):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def file_detector(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def file_detector(self, detector):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def orientation(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def orientation(self, value):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def application_cache(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def log_types(self):")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("def get_log(self, log_type):")]),t._v(" "),e("td")])])]),t._v(" "),e("h2",{attrs:{id:"浏览器下载设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器下载设置"}},[t._v("#")]),t._v(" 浏览器下载设置")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/SeleniumHQ/selenium/issues/5722",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/SeleniumHQ/selenium/issues/5722"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/SeleniumHQ/selenium/issues/5159",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/SeleniumHQ/selenium/issues/5159"),e("OutboundLink")],1)])]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 向Selenium Webwdriver添加对Chrome "send_command"的支持')]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("command_executor"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_commands"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"send_command"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/session/$sessionId/chromium/send_command'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# allow自动、deny禁止、default默认")]),t._v("\nparams "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cmd'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Page.setDownloadBehavior'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'params'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'behavior'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deny'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'downloadPath'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\\\"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"send_command"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" params"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_cdp_cmd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Page.setDownloadBehavior"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'behavior'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deny'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'downloadPath'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\\\"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"打开新标签页"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#打开新标签页"}},[t._v("#")]),t._v(" 打开新标签页")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取主窗口句柄")]),t._v("\nmain_window "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current_window_handle\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过执行js打开新标签页并访问url")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_script"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string-interpolation"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("f\"window.open('")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("')\"")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在新选项卡中打开空白页面")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#driver.execute_script(f\"window.open('','_blank')\")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取当前所有窗口句柄（窗口A、B），并切换到新标签页")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window_handles"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问url")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#driver.get(url)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭当前窗口。")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭新选项卡后回到主窗口，必须做这一步，否则会引发错误")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("main_window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("strong",[t._v("使用组合键")])]),t._v(" "),e("blockquote",[e("p",[t._v("该方式在Chrome下无效")])]),t._v(" "),e("blockquote",[e("p",[t._v("在增加了设置下载路径代码后，无法打开新标签页，但是捕获到的handler是两个，可以进行切换，只是没有切换动态效果了，实际是切换了的")])]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("OSX")]),t._v("操作系统通过组合键"),e("kbd",[t._v("COMMAND")]),t._v(" + "),e("kbd",[t._v("T")]),t._v("或"),e("kbd",[t._v("COMMAND")]),t._v(" + "),e("kbd",[t._v("W")]),t._v("来实现选项卡的打开/关闭")])]),t._v(" "),e("blockquote",[e("p",[t._v("在其他操作系统上，可以使用"),e("kbd",[t._v("CONTROL")]),t._v(" + "),e("kbd",[t._v("T")]),t._v(" / "),e("kbd",[t._v("CONTROL"),e("kbd",[t._v(" + "),e("kbd",[t._v("W")])])])])]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows 用Keys.CONTROL 如同ctrl+t打开新标签页")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_tag_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONTROL "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'t'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# <CTRL> + <T>通过Action链发送")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# ActionChains(driver).key_down(Keys.CONTROL).send_keys("t").key_up(Keys.CONTROL).perform()')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取当前所有窗口句柄（窗口A、B），并切换到新标签页")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window_handles"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问url")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows 用Keys.CONTROL 如同ctrl+w关闭标签页")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#driver.find_element_by_tag_name('body').send_keys(Keys.CONTROL + 'w')")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭当前窗口。")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"执行javascript"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行javascript"}},[t._v("#")]),t._v(" 执行JavaScript")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过 js 移动到最下")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_script"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"var q=document.documentElement.scrollTop=10000"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过 js 返回所有html")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_script"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"return document.documentElement.outerHTML"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"m3u8解析下载解密合并"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#m3u8解析下载解密合并"}},[t._v("#")]),t._v(" m3u8解析下载解密合并")]),t._v(" "),e("blockquote",[e("p",[t._v("M3U8有两层：第一层存放的是流信息（EXT-X-STREAM-INF）和第二层的下载链接，第二层才是存放加密（EXT-X-KEY）和"),e("code",[t._v("ts")]),t._v("文件的下载地址")])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/globocom/m3u8",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/globocom/m3u8"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.jianshu.com/p/2a5403234b14",target:"_blank",rel:"noopener noreferrer"}},[t._v("什么是m3u8文件"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.junmajinlong.com/others/ts_m3u8",target:"_blank",rel:"noopener noreferrer"}},[t._v("加密的ts+m3u8合并"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.cnblogs.com/String-Lee/p/11391893.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于m3u8格式的视频文件ts转mp4下载和key加密问题"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://gist.github.com/larvata/95df619df7109d8b74d2b965a3266354",target:"_blank",rel:"noopener noreferrer"}},[t._v("将TS转换为MP4"),e("OutboundLink")],1)])]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" urllib"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parse "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" urljoin\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" m3u8\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" glob "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" iglob\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" natsort "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" natsorted\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dataclasses "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" dataclass\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" concurrent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("futures "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ThreadPoolExecutor\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pip3 install pycryptodome")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入python安装目录，如C:\\python37")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在\\Lib\\site-packages目录下找到：")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# crypto这个目录重命名为: Crypto")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Crypto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cipher "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" AES\n\nUserAgent "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 "')]),t._v(" \\\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Safari/537.36"')]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@dataclass")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DownLoadM3U8")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    m3u8_url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v("\n    file_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("__post_init__")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("thread_pool "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ThreadPoolExecutor"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("max_workers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("file_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("file_name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'new.mp4'")]),t._v("\n        self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" m3u8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cryptor "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n        获取key进行解密，这里可以获取method加密方式进行解密\n        """')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keys "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            res "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("absolute_uri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" UserAgent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# AES 解密")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" AES"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("new"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AES"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MODE_CBC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_ts_url")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" seg "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("segments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" urljoin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base_uri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" seg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("download_ts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url_info"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n        下载ts文件，写入时如果有加密需要解密\n        """')]),t._v("\n        url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ts_name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" url_info\n        res "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" UserAgent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ts_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wb'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" fp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cryptor "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                fp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cryptor"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decrypt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                fp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("download_all_ts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        ts_urls "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_ts_url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ts_url "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("enumerate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ts_urls"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("thread_pool"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("submit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download_ts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ts_url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string-interpolation"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v(".ts'")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 此方式可能使视频合并时顺序错乱")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for file in self.m3u8_obj.files:")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     url = urljoin(self.m3u8_obj.base_uri, file)")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#     self.thread_pool.submit(self.download_ts, [url, url[url.rfind("/") + 1:]])')]),t._v("\n        self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("thread_pool"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shutdown"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果是第一层M3U8文件，那么就获取第二层的url")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("playlists "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"playlists"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_url "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" urljoin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base_uri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"playlists"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uri"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__post_init__"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("segments "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("or")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m3u8_obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("files"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" ValueError"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"m3u8数据不正确，请检查"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download_all_ts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        ts_path "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.ts'")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("file_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wb'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" fn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" ts "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" natsorted"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iglob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ts_path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rb'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                    sc_line "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    fn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sc_line"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("os"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remove"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" ts "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" iglob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ts_path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" os"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exists"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key.key"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            os"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remove"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key.key"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__main__'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# aHR0cHM6Ly93d3cuMTAyNHV1LmNjL3ZvZC9saXN0aW5nLTQtMC0wLTAtMC0wLTAtMC0wLTEuaHRtbA==")]),t._v("\n    m3u8_url "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://zk.wb699.com/2019/03/06/aLdpUIBeHC48HGTk/playlist.m3u8'")]),t._v("\n    file_name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n\n    start "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" time"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("time"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    M3U8 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DownLoadM3U8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m3u8_url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    M3U8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    end "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" time"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("time"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'耗时:'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" start"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=a.exports}}]);