(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{657:function(t,e,r){"use strict";r.r(e);var o=r(4),n=Object(o.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"docker"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[t._v("#")]),t._v(" Docker")]),t._v(" "),r("p"),r("div",{staticClass:"table-of-contents"},[r("ul",[r("li",[r("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),r("li",[r("a",{attrs:{href:"#仓库镜像"}},[t._v("仓库镜像")])]),r("li",[r("a",{attrs:{href:"#容器服务器"}},[t._v("容器服务器")])]),r("li",[r("a",{attrs:{href:"#docker命令"}},[t._v("Docker命令")])]),r("li",[r("a",{attrs:{href:"#docker-compose"}},[t._v("Docker compose")])]),r("li",[r("a",{attrs:{href:"#dockerfile"}},[t._v("Dockerfile")])])])]),r("p"),t._v(" "),r("h2",{attrs:{id:"flag"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/opencontainers",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/opencontainers"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/docker",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/docker"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.docker.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.docker.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://docs.docker.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.docker.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("Windows10以下安装: "),r("a",{attrs:{href:"https://github.com/docker/toolbox",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/docker/toolbox"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/boot2docker",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/boot2docker"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://juejin.im/post/5da3de28518825651b1e0633",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker及图形化管理UI Portainer的搭建"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://juejin.im/post/5da81a7d6fb9a04def4e6d6b",target:"_blank",rel:"noopener noreferrer"}},[t._v("利用Docker实现后台项目模板化配置部署"),r("OutboundLink")],1)])]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://sleele.com/2018/09/27/docker%e8%bf%9b%e9%98%b6%e5%ae%9e%e7%94%a8%e5%91%bd%e4%bb%a4/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker进阶实用命令"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://sleele.com/category/docker/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://sleele.com/category/docker/"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/virtualization",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/zh-cn/virtualization"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://developer.ibm.com/zh/technologies/containers",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.ibm.com/zh/technologies/containers"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.cnblogs.com/itoak/category/1769634.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("随笔分类 - Docker"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://kany.me/tags/docker",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://kany.me/tags/docker"),r("OutboundLink")],1)])]),t._v(" "),r("ul",[r("li",[t._v("podman "),r("a",{attrs:{href:"https://github.com/containers",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/containers"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://mp.weixin.qq.com/s/MDi4RB5V60EGl3ii9usD0Q",target:"_blank",rel:"noopener noreferrer"}},[t._v("再见 Docker，是时候拥抱下一代容器工具了"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://blog.51cto.com/13447608/2448072",target:"_blank",rel:"noopener noreferrer"}},[t._v("podman初试-和docker对比"),r("OutboundLink")],1)])])])]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"http://dockone.io/article/5679",target:"_blank",rel:"noopener noreferrer"}},[t._v("从开发者的角度比较Kubernetes和Cloud Foundry"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/kubernetes",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/kubernetes"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/kubernetes-incubator",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/kubernetes-incubator"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://kubernetes.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://kubernetes.io"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[t._v("Kubernetes的软件包管理器 "),r("a",{attrs:{href:"https://github.com/helm",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/helm"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/dapr",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/dapr"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/dokku",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/dokku"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/cloudfoundry",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cloudfoundry"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/cloudfoundry-incubator",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cloudfoundry-incubator"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.cloudfoundry.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cloudfoundry.org"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://segmentfault.com/t/cloud-foundry",target:"_blank",rel:"noopener noreferrer"}},[t._v("cloud-foundry 的动态 - SegmentFault 思否"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.terraform.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.terraform.io"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("Ansible")]),t._v(" "),r("li",[t._v("Packer")]),t._v(" "),r("li",[t._v("谷歌、IBM、微软、Pivotal、SAP、SUSE、Swisscom、GE")]),t._v(" "),r("li",[t._v("DevOps")]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/kata-containers",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/kata-containers"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.katacoda.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.katacoda.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/hyperhq",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/hyperhq"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.hyperhq.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.hyperhq.com"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/clearcontainers",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/clearcontainers"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/chaosblade-io/chaosblade",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/chaosblade-io/chaosblade"),r("OutboundLink")],1)])]),t._v(" "),r("p",[r("strong",[t._v("Docker搭建私有仓库")])]),t._v(" "),r("ul",[r("li",[t._v("企业级Registry服务器 "),r("a",{attrs:{href:"https://github.com/goharbor/harbor",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/goharbor/harbor"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.cnblogs.com/huanchupkblog/p/10843800.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker 私有仓库搭建"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.jianshu.com/p/2d9d4cdd3af7",target:"_blank",rel:"noopener noreferrer"}},[t._v("从零搭建docker私有仓库"),r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"仓库镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#仓库镜像"}},[t._v("#")]),t._v(" 仓库镜像")]),t._v(" "),r("ul",[r("li",[t._v("查找最快的docker镜像: "),r("a",{attrs:{href:"https://github.com/silenceshell/docker_mirror",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/silenceshell/docker_mirror"),r("OutboundLink")],1)])]),t._v(" "),r("ul",[r("li",[t._v("Docker官方映像 "),r("a",{attrs:{href:"https://github.com/docker-library",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/docker-library"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://hub.docker.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://hub.docker.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://hub.daocloud.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://hub.daocloud.io"),r("OutboundLink")],1)])]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.daocloud.io/mirror",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.daocloud.io/mirror"),r("OutboundLink")],1)])]),t._v(" "),r("blockquote",[r("p",[t._v("以下镜像地址需要直接配置在docker中，不能通过浏览器访问")])]),t._v(" "),r("ul",[r("li",[t._v("阿里云 "),r("a",{attrs:{href:"https://cr.console.aliyun.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cr.console.aliyun.com"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://alzgoonw.mirror.aliyuncs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://alzgoonw.mirror.aliyuncs.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://jvqgqnis.mirror.aliyuncs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jvqgqnis.mirror.aliyuncs.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://3laho3y3.mirror.aliyuncs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://3laho3y3.mirror.aliyuncs.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://cty6v5sm.mirror.aliyuncs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cty6v5sm.mirror.aliyuncs.com"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[t._v("ustc中国科技大学 "),r("a",{attrs:{href:"https://docker.mirrors.ustc.edu.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docker.mirrors.ustc.edu.cn"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("网易 "),r("a",{attrs:{href:"http://hub-mirror.c.163.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://hub-mirror.c.163.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("Docker 官方中国区 "),r("a",{attrs:{href:"https://registry.docker-cn.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://registry.docker-cn.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("Azure 中国镜像 "),r("a",{attrs:{href:"https://dockerhub.azk8s.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://dockerhub.azk8s.cn"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("七牛云加速器 "),r("a",{attrs:{href:"https://reg-mirror.qiniu.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://reg-mirror.qiniu.com"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("腾讯云 "),r("a",{attrs:{href:"https://mirror.ccs.tencentyun.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mirror.ccs.tencentyun.com"),r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"容器服务器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#容器服务器"}},[t._v("#")]),t._v(" 容器服务器")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://console.cloud.google.com/appengine",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://console.cloud.google.com/appengine"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://cloud.google.com/container-registry",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.google.com/container-registry"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/GoogleContainerTools",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/GoogleContainerTools"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://ssh.cloud.google.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ssh.cloud.google.com"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://cloud.google.com/shell/docs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.google.com/shell/docs"),r("OutboundLink")],1)])])])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://cloud.ibm.com/cloudfoundry/overview",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.ibm.com/cloudfoundry/overview"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://cloud.ibm.com/shell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.ibm.com/shell"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"http://cli.cloudfoundry.org/zh-Hans/cf",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://cli.cloudfoundry.org/zh-Hans/cf"),r("OutboundLink")],1)])]),t._v(" "),r("ul",[r("li",[t._v("使用ssh部署代码是错误的。正确做法是先进入 "),r("code",[t._v("ibmcloud target --cf")]),t._v(" 使用 "),r("code",[t._v("ibmcloud cf push")]),t._v("命令\n"),r("ul",[r("li",[r("code",[t._v('ibmcloud cf push 容器名 -b php_buildpack -m 256M -c "ls && ce /home"')])])])]),t._v(" "),r("li",[t._v("在push的代码目录里创建.bp-config配置文件，可以修改app的启动行为、可以修改"),r("code",[t._v("php.ini")]),t._v("等。否则你的container和其他服务做链接时就会被刷回原始状态。")]),t._v(" "),r("li",[t._v("10天是指开发行为，必须是类似于"),r("code",[t._v("ibm cloud cf restart")]),t._v("或者"),r("code",[t._v("cf push")]),t._v("这样的行为，可以用纯shell脚本实现。")])]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/CCChieh/IBMYes",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/CCChieh/IBMYes"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/codefresh-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/codefresh-io"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://codefresh.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://codefresh.io"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/kubesail",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/kubesail"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://kubesail.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://kubesail.com"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://azure.microsoft.com/zh-cn/services/devops/pipelines",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://azure.microsoft.com/zh-cn/services/devops/pipelines"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/containerum",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/containerum"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("樱花 "),r("a",{attrs:{href:"https://arukas.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://arukas.io"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("Oracle "),r("a",{attrs:{href:"https://app.wercker.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://app.wercker.com"),r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"docker命令"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#docker命令"}},[t._v("#")]),t._v(" Docker命令")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 退出docker容器")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果容器内部没有任何程序运行, 一旦执行exit, 退出容器时, 容器将结束运行")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看运行中的容器")]),t._v("\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看全部的容器, 包括运行中和已停止运行的容器")]),t._v("\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -a\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过容器名称删除已经停止运行的容器(test-centos为docker run命令中给容器的命名)")]),t._v("\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" test-centos\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过容器ID删除已经停止运行的容器,与上面的命令效果一样, 060e是containerID的前4位")]),t._v("\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" 060e\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 强制删除状态为Up, 正在运行中的容器")]),t._v("\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -f test-centos\n")])])]),r("h2",{attrs:{id:"docker-compose"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[t._v("#")]),t._v(" Docker compose")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://docs.docker.com/compose",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker Compose概述"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://docs.docker.com/compose/compose-file",target:"_blank",rel:"noopener noreferrer"}},[t._v("Compose文件参考"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://blog.csdn.net/qq_36148847/article/details/79427878",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker-compose.yml 配置文件编写详解"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.jianshu.com/p/658911a8cff3",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker Compose 详解"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.jianshu.com/p/2217cfed29d7",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker Compose 配置文件详解"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.jianshu.com/p/e11e01b9d675",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker run 和 docker-compose 配置挂载 Volume 并运行 nginx"),r("OutboundLink")],1)])]),t._v(" "),r("blockquote",[r("p",[t._v("Compose 文件是一个 YAML , 主要定义了 "),r("code",[t._v("services")]),t._v(","),r("code",[t._v("networks")]),t._v(" 和 "),r("code",[t._v("volumes")]),t._v("，其默认路径是 "),r("code",[t._v("./docker-compose.yml")])])]),t._v(" "),r("blockquote",[r("p",[r("code",[t._v("service")]),t._v(" 定义包含了应用与每个容器的配置，很像给 "),r("code",[t._v("docker run")]),t._v(" 传参，同样，\n"),r("code",[t._v("network")]),t._v(" 和 "),r("code",[t._v("volume")]),t._v(" 对于 "),r("code",[t._v("docker network create")]),t._v(" 和 "),r("code",[t._v("docker volume create")]),t._v(" 也类似。")])]),t._v(" "),r("blockquote",[r("p",[t._v("像在 Dockerfile （eg: "),r("code",[t._v("CMD")]),t._v(" , "),r("code",[t._v("EXPOSE")]),t._v(" , "),r("code",[t._v("VOLUME")]),t._v(" , "),r("code",[t._v("ENV")]),t._v("）可以使用的选项也可以在 "),r("code",[t._v("docker run")]),t._v("参数中使用，\n这样在 "),r("code",[t._v("docker-compose.yml")]),t._v(" 里就不需要再次指定了。")])]),t._v(" "),r("blockquote",[r("p",[r("code",[t._v("docker-compose.yml")]),t._v(" 里可以使用环境变量，类似 "),r("code",[t._v("Bash")]),t._v(" 格式 "),r("code",[t._v("${VARIABLE}")])])]),t._v(" "),r("ul",[r("li",[r("code",[t._v("composer")]),t._v(" 文件格式有两种版本：\n"),r("ul",[r("li",[r("code",[t._v("version 1")]),t._v(": 已经废弃， 不支持"),r("code",[t._v("volumes")]),t._v(" 和 "),r("code",[t._v("networks")]),t._v("，默认 "),r("code",[t._v("version key")]),t._v(" 是省略的。")]),t._v(" "),r("li",[r("code",[t._v("version 2")]),t._v(": 推荐的格式，目前是最新的，需要通过 "),r("code",[t._v("version '2'")]),t._v(" 指定。")])])])]),t._v(" "),r("p",[r("strong",[t._v("ports")])]),t._v(" "),r("blockquote",[r("p",[t._v("暴露端口。既可以是 "),r("code",[t._v("HOST:CONTAINER")]),t._v(" ，也可以只用容器端口(host端口会随机选取)。\n当以 "),r("code",[t._v("HOST:CONTAINER")]),t._v(" 的形式映射端口的时候，当容器的端口低于60的时候可能会遇到错误，\n因为YAML会解析 xx:yy 数字为60。 基于这个原因，我们推荐明确指定端口映射用字符串的形式。")])]),t._v(" "),r("p",[r("strong",[t._v("volumes")])]),t._v(" "),r("blockquote",[r("p",[t._v("挂载指定的路径或者"),r("code",[t._v("named volumes")]),t._v(", 可以在主机上指定一个路径 HOST:CONTAINER ,或者一个可访问的 HOST:CONTAINER:ro 。")])]),t._v(" "),r("h2",{attrs:{id:"dockerfile"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[t._v("#")]),t._v(" Dockerfile")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dockerfile参考"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://docs.docker.com/develop/develop-images/dockerfile_best-practices",target:"_blank",rel:"noopener noreferrer"}},[t._v("编写Dockerfile的最佳实践"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://mp.weixin.qq.com/s/2poLYm-MgAEJxCYiRZDnQw",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dockerfile 基本命令详解"),r("OutboundLink")],1)])]),t._v(" "),r("ul",[r("li",[t._v("创建"),r("code",[t._v("Dockerfile")]),t._v("文件")])]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" Dockerfile\n")])])]),r("ul",[r("li",[t._v("添加内容")])]),t._v(" "),r("div",{staticClass:"language-dockerfile extra-class"},[r("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用的基础镜像")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" centos"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("7\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 作者信息")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("MAINTAINER")]),t._v(" bajins "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"claer@bajins.com"')]),t._v("\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建目录")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" mkdir "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("p /data/java/jdk1.7.0_80\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把当前目录下的jdk文件夹添加到镜像")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" jdk1.7.0_80 /data/java/jdk1.7.0_80\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建tomcat目录")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" mkdir "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("p /data/java/tomcat"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8080\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把当前目录下的tomcat文件夹添加到镜像")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" tomcat"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8080 /data/java/tomcat"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8080\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加环境变量")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" JAVA_HOME /data/java/jdk1.7.0_80\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" CATALINA_HOME /data/java/tomcat"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8080\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" PATH $PATH"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$JAVA_HOME/bin"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$CATALINA_HOME/bin\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 暴露容器端口")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 8080\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 8090\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动时运行tomcat")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CMD")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data/java/tomcat-8080/bin/catalina.sh"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"run"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),r("div",{staticClass:"language-dockerfile extra-class"},[r("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" centos"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("7\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#安装wget工具")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" yum "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("y install wget\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#下载并且安装jdk设置环境变量")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" jdk"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8u201"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("linux"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("x64.rpm jdk"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8u201"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("linux"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("x64.rpm\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" rpm "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ivh jdk"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8u201"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("linux"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("x64.rpm\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" JAVA_HOME /usr/java/latest/\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" PATH=$JAVA_HOME/bin"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$PATH\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" CLASSPATH=."),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$JAVA_HOME/lib/dt.jar"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$JAVA_HOME/lib/tools.jar\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" rm "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rf jdk"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8u201"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("linux"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("x64.rpm\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#时区中文等处理")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && \\\n    echo "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Asia/Shanghai'")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("/etc/timezone\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" yum "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("y install kde"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("l10n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Chinese\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#配置显示中文")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" localedef "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("c "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("f UTF"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("8 "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("i zh_CN zh_CN.utf8\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" LC_ALL zh_CN.utf8\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" echo "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"export LC_ALL=zh_CN.utf8"')]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" /etc/profile\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);